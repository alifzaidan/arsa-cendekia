var H=Object.defineProperty;var W=(t,d,r)=>d in t?H(t,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[d]=r;var O=(t,d,r)=>W(t,typeof d!="symbol"?d+"":d,r);import{R as U,j as e,$ as L,r as S,L as I,S as _}from"./app-BfgZ1jJD.js";import{B as y}from"./button-BJ2tfxUg.js";import{T as Q}from"./triangle-alert-DZ4WN4RR.js";import{S as X,w as G,b as K,c as R,d as V,u as J,e as Y,f as Z,g as ee,h as se,x as te,A as re,i as ae}from"./breadcrumbs-CIofoTQN.js";import{N as ne,A as le}from"./app-sidebar-header-DinrI-BJ.js";import{I as ie}from"./icon-CJLH4TFi.js";import{A as oe,a as de,b as ce,c as me}from"./accordion-BLpvwYZP.js";import{P as ue}from"./progress-BYhUaB7T.js";import{c as xe,T as he,a as fe,b as pe}from"./tooltip-YszIhp1B.js";import{C as z}from"./circle-check-big-BvayT9Ds.js";import{C as ge}from"./dropdown-menu-D-RFvgcT.js";import{C as T}from"./circle-help-Dvg0dTjL.js";import{c as je}from"./createLucideIcon-DE9Tn2K0.js";import{F as be}from"./file-text-B1nDzX02.js";import{C as Ne}from"./circle-play-BS5DSqlw.js";import{T as ve}from"./sonner-DK45uaK0.js";import{t as $}from"./index-CUDXU6sL.js";import{C as ye}from"./chevron-left-D4wjm_3Q.js";import{C as P}from"./chevron-right-BoyAfqJq.js";import{C as we}from"./circle-x-BP8I0Vug.js";import{E as B}from"./external-link-BmNOIcoh.js";import"./index-Cmel2OYl.js";import"./index-yQBepqoG.js";import"./utils-C1iKCs30.js";import"./index-DtSPkv89.js";import"./index-tEHxzkPb.js";import"./Combination-Dyc663Sd.js";import"./x-CquPhaxv.js";import"./index-Dn_VzzJM.js";import"./index-Z40DZPLH.js";import"./floating-ui.react-dom-C37UeumF.js";import"./user-954k5RzP.js";import"./chevrons-up-down-BfiKwgcd.js";import"./proxy-0RsWF3Xe.js";import"./index-Co0ZWakJ.js";import"./index-DkgfW9Gg.js";import"./index-W6qf3D2J.js";import"./check-A_SiYeLL.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],F=je("FileDown",ke);class Ce extends U.Component{constructor(r){super(r);O(this,"retry",()=>{this.setState({hasError:!1,error:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,i){console.error("Error caught by boundary:",r,i)}render(){if(this.state.hasError){if(this.props.fallback){const r=this.props.fallback;return e.jsx(r,{error:this.state.error,retry:this.retry})}return e.jsxs("div",{className:"bg-muted/40 flex h-full flex-col items-center justify-center rounded-lg p-8 text-center",children:[e.jsx(Q,{className:"text-red-500 mb-4 h-16 w-16"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Terjadi Kesalahan"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Maaf, terjadi kesalahan tak terduga. Silakan coba lagi."}),this.state.error&&e.jsxs("details",{className:"mb-4 text-xs text-muted-foreground",children:[e.jsx("summary",{className:"cursor-pointer",children:"Detail Error"}),e.jsx("pre",{className:"mt-2 text-left bg-gray-100 p-2 rounded text-xs overflow-auto",children:this.state.error.message})]}),e.jsx(y,{onClick:this.retry,children:"Coba Lagi"})]})}return this.props.children}}function Se({items:t,className:d,...r}){return e.jsx(X,{...r,className:`group-data-[collapsible=icon]:p-0 ${d||""}`,children:e.jsx(G,{children:e.jsx(K,{children:t.map(i=>e.jsx(R,{children:e.jsx(V,{asChild:!0,className:"text-neutral-600 hover:text-neutral-800 dark:text-neutral-300 dark:hover:text-neutral-100",children:e.jsxs(L,{href:i.href,children:[i.icon&&e.jsx(ie,{iconNode:i.icon,className:"h-5 w-5"}),e.jsx("span",{children:i.title})]})})},i.title))})})})}function ze({courseSlug:t,modules:d,selectedLesson:r,setSelectedLesson:i,onLessonComplete:s,onProgressUpdate:h}){const[v,w]=S.useState(null),{state:a}=J();S.useEffect(()=>{d.length>0&&v===null&&w(d[0].id)},[d,v]);const p=[{title:"Keluar Kelas",href:`/profile/my-courses/${t}`,icon:te}],k={video:e.jsx(Ne,{className:"text-muted-foreground h-4 w-4"}),text:e.jsx(be,{className:"text-muted-foreground h-4 w-4"}),file:e.jsx(F,{className:"text-muted-foreground h-4 w-4"}),quiz:e.jsx(T,{className:"text-muted-foreground h-4 w-4"})},b=S.useMemo(()=>{const x=d.reduce((C,N)=>C+N.lessons.length,0),g=d.reduce((C,N)=>C+N.lessons.filter(E=>E.isCompleted).length,0),f=x>0?g/x*100:0;return{totalLessons:x,completedLessons:g,progressPercentage:f}},[d]);S.useEffect(()=>{const x=async()=>{var g;try{(await fetch(`/enrollment/progress/${t}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"))||""},body:JSON.stringify({progress:Math.round(b.progressPercentage)})})).ok&&h&&h(Math.round(b.progressPercentage))}catch(f){console.error("Error updating enrollment progress:",f)}};b.progressPercentage>0&&x()},[b.progressPercentage,t,h]);const q=x=>x.lessons.length>0&&x.lessons.every(g=>g.isCompleted),A=(x,g)=>{for(let f=0;f<x;f++)if(d[f].lessons.some(C=>!C.isCompleted))return!1;for(let f=0;f<g;f++)if(!d[x].lessons[f].isCompleted)return!1;return!0};return e.jsxs(Y,{collapsible:"icon",variant:"inset",children:[e.jsx(Z,{children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(K,{children:e.jsx(R,{children:e.jsx(V,{size:"lg",asChild:!0,children:e.jsxs(L,{href:"/admin/dashboard",prefetch:!0,children:[e.jsx("img",{src:"/assets/images/logo-primary.png",alt:"Arsa Cendekia",className:"block w-12 fill-current dark:hidden"}),e.jsx("img",{src:"/assets/images/logo-secondary.png",alt:"Arsa Cendekia",className:"hidden w-32 fill-current dark:block"})]})})})})})}),e.jsxs(ee,{children:[a==="expanded"&&e.jsx("div",{className:"border-b px-4 py-3",children:e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Progress Pembelajaran"}),e.jsxs("span",{className:"text-muted-foreground",children:[b.completedLessons,"/",b.totalLessons]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(ue,{value:b.progressPercentage,className:"h-2 border border-gray-200 bg-white"})}),e.jsx("div",{className:"mt-1 text-right",children:e.jsxs("span",{className:"text-muted-foreground text-xs",children:[Math.round(b.progressPercentage),"% selesai"]})})]})}),e.jsx(oe,{className:"w-full",expandedValue:v,onValueChange:w,children:d.map((x,g)=>e.jsxs(de,{value:x.id,children:[e.jsx(ce,{className:"px-2 text-left text-sm font-semibold hover:no-underline",children:e.jsxs("div",{className:"flex w-full items-center gap-2",children:[a==="collapsed"?e.jsx("span",{className:"flex-1 truncate",children:x.title.length>4?x.title.slice(0,4)+"...":x.title}):e.jsx("span",{className:"flex-1",children:x.title}),q(x)&&e.jsx(z,{className:"h-4 w-4 text-green-600"})]})}),e.jsx(me,{children:e.jsx("ul",{className:"space-y-1",children:x.lessons.map((f,C)=>{const N=A(g,C);return e.jsx("li",{className:"group",children:e.jsx("div",{className:`flex items-center gap-2 ${a==="collapsed"?"justify-center":""}`,children:e.jsx(xe,{children:e.jsxs(he,{children:[e.jsx(fe,{asChild:!0,children:e.jsxs("button",{onClick:()=>N&&i(f),className:`rounded-md p-2 text-left text-sm transition-colors ${a==="collapsed"?"flex h-10 w-10 items-center justify-center":"flex flex-1 items-center gap-2"} ${(r==null?void 0:r.id)===f.id?"bg-accent text-accent-foreground":N?"text-muted-foreground hover:bg-accent hover:text-foreground":"cursor-not-allowed text-gray-400 opacity-60"}`,disabled:!N,tabIndex:N?0:-1,children:[k[f.type],a==="expanded"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1",children:f.title}),f.isCompleted?e.jsx(z,{className:"h-4 w-4 text-green-600"}):e.jsx(ge,{className:"h-4 w-4"})]})]})}),!N&&e.jsx(pe,{side:"right",children:"Silahkan selesaikan materi sebelumnya terlebih dahulu"})]})})})},f.id)})})})]},x.id))})]}),e.jsxs(se,{children:[e.jsx(Se,{items:p}),e.jsx(ne,{})]})]})}const qe=({children:t,breadcrumbs:d,courseSlug:r,courseTitle:i,modules:s,selectedLesson:h,setSelectedLesson:v,onLessonComplete:w,...a})=>{const p=async k=>{var b;try{(await fetch(`/lesson/${k}/complete`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((b=document.querySelector('meta[name="csrf-token"]'))==null?void 0:b.getAttribute("content"))||""}})).ok&&(w==null||w(k))}catch(q){console.error("Error completing lesson:",q)}};return e.jsxs(re,{variant:"sidebar",...a,children:[e.jsx(ze,{courseSlug:r,modules:s,selectedLesson:h,setSelectedLesson:v,onLessonComplete:p}),e.jsxs(ae,{variant:"sidebar",children:[e.jsx(le,{breadcrumbs:d,hideSidebarTrigger:!1,courseTitle:i}),t,e.jsx(ve,{position:"top-center",richColors:!0})]})]})};function Te(t){if(!t)return"";const d=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,r=t.match(d);if(r&&r[1])return`https://www.youtube-nocookie.com/embed/${r[1]}?rel=0&modestbranding=1&showinfo=0&controls=1&disablekb=1`;if(t.includes("youtube.com/embed/")){const i=t.replace("youtube.com","youtube-nocookie.com"),s=i.includes("?")?"&":"?";return`${i}${s}rel=0&modestbranding=1&showinfo=0&controls=1&disablekb=1`}return t}function Ae({lesson:t}){const[d,r]=S.useState(!1),i=Te(t.video_url||"");return d||!i||i===t.video_url?e.jsxs("div",{className:"bg-muted/40 flex h-full flex-col items-center justify-center rounded-lg p-8 text-center",children:[e.jsx(B,{className:"text-muted-foreground mb-4 h-16 w-16"}),e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Video External"}),e.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:"Video tidak dapat ditampilkan langsung di halaman ini"}),e.jsx(y,{asChild:!0,children:e.jsxs("a",{href:t.video_url,target:"_blank",rel:"noopener noreferrer",children:["Tonton Video ",e.jsx(B,{className:"ml-2 h-4 w-4"})]})})]}):e.jsx("iframe",{src:i,title:t.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,className:"h-full w-full rounded-lg",loading:"lazy",onError:()=>r(!0),style:{border:"none",outline:"none"}})}function Ee({lesson:t,onStartQuiz:d}){var w,a;const r=(w=t.quizzes)==null?void 0:w[0];if(!r)return e.jsxs("div",{className:"bg-muted/40 flex h-full flex-col items-center justify-center rounded-lg p-8 text-center",children:[e.jsx(T,{className:"text-muted-foreground mb-4 h-16 w-16"}),e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Quiz Belum Tersedia"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Quiz untuk materi ini belum tersedia."})]});const i=r.attempts||[],s=i.find(p=>p.is_passed),h=()=>{_.get(`/quiz/${r.id}/start`)},v=()=>{_.get(`/quiz/${r.id}/answers`)};return e.jsxs("div",{className:"mx-auto max-w-4xl p-6",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"mb-4 inline-flex h-16 w-16 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:e.jsx(T,{className:"h-8 w-8"})}),e.jsx("h2",{className:"mb-2 text-2xl font-bold",children:r.title}),r.instructions&&e.jsx("p",{className:"text-muted-foreground mb-4",children:r.instructions}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"bg-card rounded-lg border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((a=r.questions)==null?void 0:a.length)||0}),e.jsx("div",{className:"text-muted-foreground text-sm",children:"Total Soal"})]}),e.jsx("div",{className:"bg-card flex min-h-[72px] flex-col items-center justify-center rounded-lg border p-4",children:r.time_limit===0?e.jsx("div",{className:"flex h-full min-h-[48px] items-center justify-center text-sm font-semibold text-red-600",children:"Tanpa Batas Waktu"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.time_limit}),e.jsx("div",{className:"text-muted-foreground text-sm",children:"Menit"})]})}),e.jsxs("div",{className:"bg-card rounded-lg border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.passing_score}),e.jsx("div",{className:"text-muted-foreground text-sm",children:"Nilai Lulus"})]})]})]}),i.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Riwayat Nilai"}),e.jsx("div",{className:"space-y-3",children:i.map((p,k)=>e.jsx("div",{className:`rounded-lg border p-4 ${p.is_passed?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[p.is_passed?e.jsx(z,{className:"h-5 w-5 text-green-600"}):e.jsx(we,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["Percobaan ",i.length-k,p.is_passed&&e.jsx("span",{className:"ml-2 rounded-full bg-green-100 px-2 py-1 text-xs text-green-700",children:"LULUS"})]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:new Date(p.submitted_at).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-2xl font-bold ${p.is_passed?"text-green-600":"text-red-600"}`,children:[Math.round(p.score),"%"]}),e.jsxs("div",{className:"text-muted-foreground text-sm",children:[p.correct_answers,"/",p.total_questions," benar"]}),e.jsxs("div",{className:"text-muted-foreground text-sm",children:["Waktu Pengerjaan: ",Math.floor(p.time_taken/60),":",(p.time_taken%60).toString().padStart(2,"0")]})]})]})},p.id))})]}),e.jsxs("div",{className:"text-center",children:[s?e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4 inline-flex items-center gap-2 rounded-lg bg-green-100 px-4 py-2 text-green-600",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Anda sudah lulus quiz ini!"})]}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Selamat! Anda bisa mengulang quiz ini kapan saja untuk meningkatkan pemahaman."})]}):e.jsx("div",{className:"mb-6",children:i.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 inline-flex items-center gap-2 rounded-lg bg-amber-100 px-4 py-2 text-amber-600",children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Belum lulus, jangan menyerah!"})]}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Pelajari kembali materi dan coba lagi. Anda bisa mengulang quiz ini tanpa batas."})]}):e.jsx("p",{className:"text-muted-foreground mb-4",children:"Siap untuk mengerjakan quiz? Anda bisa mengulang quiz ini tanpa batas waktu."})}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-center",children:[e.jsx(y,{onClick:h,size:"lg",className:"gap-2",children:i.length>0?"🔄 Ulangi Quiz":"🚀 Mulai Quiz"}),i.length>0&&e.jsx(e.Fragment,{children:e.jsxs(y,{onClick:v,variant:"outline",size:"lg",className:"gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Lihat Pembahasan"]})})]})]})]})}function Me({lesson:t,onQuizComplete:d,courseSlug:r}){if(!t)return e.jsx("div",{className:"bg-muted/40 flex h-full items-center justify-center rounded-lg",children:e.jsx("p",{children:"Pilih materi untuk memulai belajar."})});const i=()=>{var h;const s=(h=t.quizzes)==null?void 0:h[0];s!=null&&s.id?_.get(`/quiz/${s.id}`):$.error("Quiz tidak tersedia")};switch(t.type){case"video":return e.jsx("div",{className:"aspect-video w-full",children:e.jsx(Ae,{lesson:t})});case"text":return e.jsx("div",{className:"prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:t.content||""}});case"file":{if(!t.attachment)return e.jsxs("div",{className:"bg-muted/40 flex h-full flex-col items-center justify-center rounded-lg p-8 text-center",children:[e.jsx(F,{className:"text-muted-foreground mb-4 h-16 w-16"}),e.jsx("h3",{className:"text-lg font-semibold",children:"File Tidak Tersedia"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"File materi tidak ditemukan."})]});const s=t,h=s.is_preview===!0||s.is_preview===1,v=t.attachment&&t.attachment.toLowerCase().endsWith(".pdf");return e.jsxs("div",{className:"w-full",children:[!h&&e.jsx("div",{className:"mb-4 rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-blue-900",children:"Silahkan download file ini untuk melanjutkan ke materi selanjutnya"}),e.jsx(y,{asChild:!0,className:"flex items-center gap-2",children:e.jsxs("a",{href:`/storage/${t.attachment}`,download:!0,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(F,{className:"h-4 w-4"})," Download File"]})})]})}),e.jsx("div",{className:"h-[600px] w-full",children:v?e.jsx("iframe",{src:`/storage/${t.attachment}#toolbar=0&navpanes=0&scrollbar=0`,title:t.title,className:"h-full w-full rounded-lg border",style:{border:"none",outline:"none"}}):e.jsx("div",{className:"text-muted-foreground flex h-full items-center justify-center text-sm italic",children:"Preview hanya tersedia untuk file PDF."})})]})}case"quiz":return e.jsx(Ce,{children:e.jsx(Ee,{lesson:t,onStartQuiz:i})});default:return e.jsx("div",{children:"Tipe materi tidak dikenal."})}}function js({course:t,auto_select_lesson_id:d,progress_info:r}){var C,N,E,D;const i=t.modules&&t.modules.length>0?t.modules:[],[s,h]=S.useState(()=>{var l;const n=window.location.hash;if(n&&n.startsWith("#quiz-")){const o=n.replace("#quiz-",""),u=i.flatMap(c=>c.lessons).find(c=>c.id===o);if(u)return u}if(d){const o=i.flatMap(u=>u.lessons).find(u=>u.id===d);if(o)return o}return((l=i[0])==null?void 0:l.lessons[0])||null}),[v,w]=S.useState(!1),[a,p]=S.useState(()=>i.map(n=>({...n,lessons:n.lessons.map(l=>{let o=l.isCompleted||!1;if(l.type==="quiz"&&l.quizzes&&l.quizzes.length>0){const u=l.quizzes.some(c=>c.attempts&&c.attempts.length>0);o=o||u}return{...l,isCompleted:o}})})));S.useEffect(()=>{const n=window.location.hash;if(n&&n.startsWith("#quiz-")){const l=n.replace("#quiz-",""),o=a.flatMap(u=>u.lessons).find(u=>u.id===l);o&&(h(o),window.history.replaceState(null,"",window.location.pathname),console.log("Kembali ke dashboard quiz:",o.title))}},[a]),S.useEffect(()=>{r&&s&&(r.has_incomplete_lessons&&s.id===r.next_incomplete_lesson_id?$.success(`Melanjutkan pembelajaran: ${s.title}`):r.has_completed_lessons&&s.id===r.last_completed_lesson_id&&$.info("Kembali ke materi terakhir yang diselesaikan"))},[r,s]);const k=async n=>{var l,o;try{if((await fetch(`/lesson/${n}/complete`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""}})).ok){p(m=>m.map(j=>({...j,lessons:j.lessons.map(M=>M.id===n?{...M,isCompleted:!0}:M)})));let c=!1;for(let m=0;m<a.length;m++){for(let j=0;j<a[m].lessons.length;j++)if(a[m].lessons[j].id===n){c=!0,j+1<a[m].lessons.length?h(a[m].lessons[j+1]):m+1<a.length&&a[m+1].lessons.length>0&&h(a[m+1].lessons[0]);break}if(c)break}try{await fetch(`/enrollment/progress/${t.slug}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||""}})}catch(m){console.error("Error updating enrollment progress:",m)}}}catch(u){console.error("Error completing lesson:",u)}},b=[{title:t.title,href:`learn/course/${t.slug}`}],q=n=>{for(const l of a)if(l.lessons.some(o=>o.id===n))return l.title;return""},A=s?e.jsx(Me,{lesson:s,onQuizComplete:k,courseSlug:t.slug}):null;if((s==null?void 0:s.type)==="quiz"&&v)return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:(s==null?void 0:s.title)||t.title}),A]});const x=a.every(n=>n.lessons.every(l=>l.isCompleted)),g=(()=>{if(!s||a.length===0)return!1;const n=a[a.length-1];return n.lessons.length===0?!1:s.id===n.lessons[n.lessons.length-1].id})(),f=n=>{if(n.type!=="quiz"||!n.quizzes||n.quizzes.length===0)return{hasAttempt:!1,hasPassed:!1};const l=n.quizzes[0],o=l.attempts&&l.attempts.length>0,u=l.attempts&&l.attempts.some(c=>c.is_passed);return{hasAttempt:o,hasPassed:u}};return e.jsxs(qe,{breadcrumbs:b,courseSlug:t.slug,courseTitle:t.title,modules:a,selectedLesson:s,setSelectedLesson:h,onLessonComplete:k,children:[e.jsx(I,{title:(s==null?void 0:s.title)||t.title}),e.jsxs("div",{className:"m-4 h-full",children:[e.jsxs("div",{className:"mb-4",children:[s&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"text-muted-foreground text-sm font-medium",children:q(s.id)})}),e.jsx("h1",{className:"text-2xl font-bold",children:s==null?void 0:s.title})]}),e.jsx("div",{className:"bg-card mb-4 rounded-lg border p-4",children:A}),e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(y,{variant:"outline",onClick:()=>{let n=null,l=!1;for(const o of a){for(let u=0;u<o.lessons.length;u++)if(o.lessons[u].id===(s==null?void 0:s.id)){if(u>0)n=o.lessons[u-1];else{const c=a.indexOf(o);if(c>0){const m=a[c-1];n=m.lessons[m.lessons.length-1]}}l=!0;break}if(l)break}n&&h(n)},disabled:!s||((N=(C=a[0])==null?void 0:C.lessons[0])==null?void 0:N.id)===(s==null?void 0:s.id),className:"gap-2 disabled:cursor-not-allowed",children:[e.jsx(ye,{className:"h-4 w-4"})," Sebelumnya"]})}),s&&s.type==="quiz"?(()=>{var u;(u=a.find(c=>c.lessons.find(m=>m.id===s.id)))==null||u.lessons.find(c=>c.id===s.id);const n=f(s);let l=null,o=!1;for(const c of a){for(let m=0;m<c.lessons.length;m++)if(c.lessons[m].id===s.id){if(m<c.lessons.length-1)l=c.lessons[m+1];else{const j=a.indexOf(c);j<a.length-1&&(l=a[j+1].lessons[0])}o=!0;break}if(o)break}return n.hasAttempt?n.hasPassed?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-green-50 px-4 py-2 text-green-600",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Quiz Lulus ✨"})]}),l&&!g&&e.jsxs(y,{variant:"outline",onClick:()=>h(l),className:"gap-2",children:["Selanjutnya ",e.jsx(P,{className:"h-4 w-4"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-amber-50 px-4 py-2 text-amber-600",children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Quiz Selesai (Bisa Diulang)"})]}),l&&!g&&e.jsxs(y,{variant:"outline",onClick:()=>h(l),className:"gap-2",children:["Selanjutnya ",e.jsx(P,{className:"h-4 w-4"})]})]}):e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-blue-50 px-4 py-2 text-blue-600",children:[e.jsx(T,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Kerjakan Quiz untuk Melanjutkan"})]})})():s&&s.type!=="quiz"&&((D=(E=a.find(n=>n.lessons.find(l=>l.id===s.id)))==null?void 0:E.lessons.find(n=>n.id===s.id))!=null&&D.isCompleted?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-green-50 px-4 py-2 text-green-600",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Materi Sudah Selesai"})]}),(()=>{if(!s||a.length===0)return null;const n=a[a.length-1];if(n.lessons.length===0||s.id===n.lessons[n.lessons.length-1].id)return null;let o=null,u=!1;for(const c of a){for(let m=0;m<c.lessons.length;m++)if(c.lessons[m].id===s.id){if(m<c.lessons.length-1)o=c.lessons[m+1];else{const j=a.indexOf(c);j<a.length-1&&(o=a[j+1].lessons[0])}u=!0;break}if(u)break}return o?e.jsxs(y,{variant:"outline",onClick:()=>h(o),className:"gap-2",children:["Selanjutnya ",e.jsx(P,{className:"h-4 w-4"})]}):null})()]}):e.jsxs(y,{onClick:()=>k(s.id),size:"lg",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Selesaikan Materi"]}))]}),x&&g&&e.jsxs("div",{className:"mt-4 flex flex-col items-center justify-center gap-4 md:flex-row",children:[e.jsx("div",{className:"rounded-lg bg-green-100 px-4 py-2 text-center text-sm font-medium text-green-700",children:"🎉 Selamat! Anda sudah menyelesaikan semua materi kelas"}),e.jsx(y,{asChild:!0,size:"lg",children:e.jsx(L,{href:`/profile/my-courses/${t.slug}`,children:"Download Sertifikat 🎓"})})]})]})]})}export{js as default};
