import{K as D,r as u,j as e,S as T}from"./app-BfgZ1jJD.js";import{D as A}from"./delete-dialog-DPIX4Sl9.js";import{B as U}from"./badge-CQkAYN-A.js";import{B as g}from"./button-BJ2tfxUg.js";import{I as N}from"./input-DAiJIf4x.js";import{T as P,d as H,b as t,e as a}from"./table-CC6On7Cv.js";import{r as v}from"./utils-C1iKCs30.js";import{t as n}from"./index-CUDXU6sL.js";import B from"./create-recording-url-Ch0HJv-2.js";import{L as _}from"./link-1eQx7Qyb.js";import{T as C}from"./trash-2-BM1bzNMz.js";import{f as c}from"./format-Bp4OdCl_.js";import{i as o}from"./id-Don4TG_0.js";import"./alert-dialog-KBGciRPH.js";import"./index-DtSPkv89.js";import"./index-tEHxzkPb.js";import"./index-Cmel2OYl.js";import"./Combination-Dyc663Sd.js";import"./index-yQBepqoG.js";import"./input-error--WoyB8xM.js";import"./dialog-CblXDkko.js";import"./x-CquPhaxv.js";import"./createLucideIcon-DE9Tn2K0.js";import"./label-wqJbabk0.js";import"./plus-DZVpJj3c.js";function I(s){const l=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,i=s.match(l);return i&&i[2].length===11?i[2]:""}function de({webinar:s}){var y;const{auth:l}=D().props,i=l.role.includes("affiliate"),[f,h]=u.useState(!1),[j,k]=u.useState("");u.useEffect(()=>{if(s.recording_url){const r=I(s.recording_url);k(r?`https://www.youtube.com/embed/${r}`:"")}else k("")},[s.recording_url]);const m=u.useMemo(()=>{const r=l.user.affiliate_code,d=(p,b)=>{try{const x=new URL(p);return x.searchParams.set("ref",b),x.toString()}catch{const x=p.includes("?")?"&":"?";return`${p}${x}ref=${b}`}};return i&&r?{registrationUrl:d(s.registration_url,r),webinarUrl:d(s.webinar_url,r)}:{registrationUrl:s.registration_url,webinarUrl:s.webinar_url}},[s.registration_url,s.webinar_url,l.user.affiliate_code,i]),L=async()=>{try{await navigator.clipboard.writeText(m.registrationUrl),i?n.success("Link pendaftaran dengan kode afiliasi berhasil disalin!"):n.success("Link pendaftaran berhasil disalin!")}catch{n.error("Gagal menyalin link pendaftaran")}},S=async()=>{try{await navigator.clipboard.writeText(m.webinarUrl),i?n.success("Link webinar dengan kode afiliasi berhasil disalin!"):n.success("Link webinar berhasil disalin!")}catch{n.error("Gagal menyalin link webinar")}},M=()=>{h(!0),T.delete(route("webinars.recording.remove",s.id),{onSuccess:()=>{n.success("Link rekaman berhasil dihapus!"),h(!1)},onError:r=>{console.error("Error deleting recording:",r),n.error("Gagal menghapus link rekaman"),h(!1)}})};return e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Share Link untuk Menerima Pendaftaran"}),i&&e.jsx("div",{className:"rounded-full bg-green-100 px-3 py-1 text-xs font-medium text-green-800",children:"Mode Afiliasi"})]}),i&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-900/20",children:e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Link Afiliasi Otomatis"}),e.jsxs("p",{className:"mt-1 text-sm text-blue-700 dark:text-blue-300",children:["Link di bawah sudah menyertakan kode afiliasi Anda (",l.user.affiliate_code,"). Setiap pendaftaran melalui link ini akan memberikan komisi untuk Anda."]})]})})}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Link Pendaftaran ",i&&"(dengan kode afiliasi)"]}),e.jsx(N,{type:"text",value:m.registrationUrl,readOnly:!0,className:"rounded border p-2 text-sm",placeholder:"Link Pendaftaran"}),e.jsxs(g,{type:"button",onClick:L,className:"w-full hover:cursor-pointer",disabled:s.status==="draft"||s.status==="archived",children:[i?"Salin Link Afiliasi Pendaftaran":"Salin Link Pendaftaran"," ",e.jsx(_,{})]})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Link Webinar ",i&&"(dengan kode afiliasi)"]}),e.jsx(N,{type:"text",value:m.webinarUrl,readOnly:!0,className:"rounded border p-2 text-sm",placeholder:"Link Webinar"}),e.jsxs(g,{type:"button",onClick:S,className:"w-full hover:cursor-pointer",disabled:s.status==="draft"||s.status==="archived",children:[i?"Salin Link Afiliasi Webinar":"Salin Link Webinar"," ",e.jsx(_,{})]})]})]}),s.status==="published"?e.jsx("p",{className:"text-muted-foreground text-center text-sm",children:i?"Share link afiliasi diatas ke sosial media, whatsapp, tiktok, landing page, email ataupun channel penjualan lainnya untuk mendapatkan komisi dari setiap pendaftaran":"Share link diatas ke sosial media, whatsapp, tiktok, landing page, email ataupun channel penjualan lainnya untuk menerima order dan pembayaran"}):e.jsx("p",{className:"text-center text-sm text-red-500",children:"Webinar ini belum diterbitkan. Silakan terbitkan webinar terlebih dahulu untuk membagikan link akses webinar."}),i&&s.status==="published"&&e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("h4",{className:"mb-2 text-sm font-medium",children:"Detail Link Afiliasi:"}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Link Asli:"})," ",s.registration_url]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Kode Afiliasi:"})," ",l.user.affiliate_code]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rate Komisi:"})," ",l.user.commission,"%"]})]})]}),e.jsx(P,{children:e.jsxs(H,{children:[e.jsxs(t,{children:[e.jsx(a,{children:"Status"}),e.jsx(a,{children:(()=>{const r=s.status;let d="bg-gray-200 text-gray-800";return r==="draft"&&(d="bg-gray-200 text-gray-800"),r==="published"&&(d="bg-blue-100 text-blue-800"),r==="archived"&&(d="bg-zinc-300 text-zinc-700"),e.jsx(U,{className:`capitalize ${d} border-0`,children:r})})()})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Kategori"}),e.jsx(a,{children:(y=s.category)==null?void 0:y.name})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Nama Webinar"}),e.jsx(a,{children:s.title})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Harga"}),e.jsx(a,{children:s.price===0?e.jsx("span",{children:"Gratis"}):e.jsxs("span",{children:[s.strikethrough_price>0&&e.jsxs("span",{className:"text-xs text-gray-500 line-through",children:[v.format(s.strikethrough_price)," "]}),e.jsx("span",{className:"text-base font-semibold",children:v.format(s.price)})]})})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Deskripsi"}),e.jsx(a,{children:e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:s.description??"-"}})})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Benefit"}),e.jsx(a,{children:e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:s.benefits??"-"}})})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Batch"}),e.jsx(a,{children:s.batch??"-"})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Kuota"}),e.jsx(a,{children:s.quota===0?"Tak terbatas":s.quota})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Waktu Pelaksanaan"}),e.jsxs(a,{children:[c(new Date(s.start_time),"dd MMMM yyyy",{locale:o})," ",c(new Date(s.start_time),"HH:mm",{locale:o})," -"," ",c(new Date(s.end_time),"dd MMMM yyyy",{locale:o})," ",c(new Date(s.end_time),"HH:mm",{locale:o})]})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Deadline Pendaftaran"}),e.jsx(a,{children:c(new Date(s.registration_deadline),"dd MMMM yyyy HH:mm",{locale:o})})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Link Group Peserta"}),e.jsx(a,{children:s.group_url??"-"})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Pemateri"}),e.jsxs(a,{children:[e.jsx("div",{children:s.host_name??"-"}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s.host_description??""})]})]}),e.jsxs(t,{children:[e.jsx(a,{children:"Link Rekaman"}),e.jsx(a,{children:e.jsx("div",{className:"space-y-3",children:s.recording_url?e.jsxs("div",{className:"space-y-2",children:[j&&e.jsx("div",{children:e.jsx("div",{className:"mt-2 w-full",children:e.jsx("iframe",{className:"aspect-video w-2/3 rounded-lg border",src:j,title:"YouTube Preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("a",{href:s.recording_url,target:"_blank",rel:"noopener noreferrer",className:"flex-1 text-sm break-all text-blue-600 hover:underline",children:s.recording_url})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{webinarId:s.id,currentRecordingUrl:s.recording_url}),e.jsx(A,{trigger:e.jsxs(g,{size:"sm",variant:"destructive",disabled:f,className:"flex items-center gap-1",children:[e.jsx(C,{className:"h-3 w-3"}),f?"Menghapus...":"Hapus"]}),title:"Apakah Anda yakin ingin menghapus link rekaman ini?",itemName:"Link rekaman webinar",onConfirm:M})]})]}):e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm text-gray-500",children:"Belum ada link rekaman"})})})})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Tools yang Digunakan:"}),s.tools&&s.tools.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-4 md:grid-cols-4 lg:grid-cols-5",children:s.tools.map(r=>e.jsxs("div",{children:[e.jsx("img",{src:r.icon?`/storage/${r.icon}`:"/assets/images/placeholder.png",alt:"Tool Icon",className:"mx-auto my-1 mt-2 h-24 rounded border object-cover"}),e.jsx("h4",{className:"text-center text-sm font-medium",children:r.name})]},r.name))}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"Belum ada tools yang ditentukan."})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Thumbnail:"}),e.jsx("img",{src:s.thumbnail?`/storage/${s.thumbnail}`:"/assets/images/placeholder.png",alt:s.title,className:"my-1 mt-2 h-40 w-64 rounded border object-cover"}),s.thumbnail?null:e.jsx("span",{className:"text-muted-foreground text-sm",children:"Thumbnail belum diunggah."})]})]})}export{de as default};
