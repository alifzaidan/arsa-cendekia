import{r as s,j as e}from"./app-k8zswjN4.js";import{I as R}from"./input-error-D_1uxFxj.js";import{B as P}from"./button-DXavOchq.js";import{b as B,c as Q,d as V,e as X,f as O}from"./dialog-BuCqyxzX.js";import{I as m}from"./input-Dxh7gntF.js";import{L as a}from"./label-C9tmqixz.js";import{S as A,a as J,b as K,c as Y,e as W,d}from"./select-CuoiEqfK.js";import{S as T}from"./switch-aItqevB1.js";import{T as I}from"./textarea-CrTrU_lC.js";import{E as G}from"./Editor-CxYzFplX.js";import"./utils-CkV0Qb-V.js";import"./index-yeKsPfmp.js";import"./index-pHOxZwLY.js";import"./index-pXs-r0Ho.js";import"./index-D6V9crY2.js";import"./Combination-BrdjsB_W.js";import"./x-Brw5WuUb.js";import"./createLucideIcon-D-iNy-Um.js";import"./index-6vY0h7jb.js";import"./index-DBFJEYa8.js";import"./floating-ui.react-dom-CRZWRie3.js";import"./index-BV5r0t8n.js";import"./index-Bxzk6A-r.js";import"./index-DQoMunvF.js";import"./chevron-down-C51sm_3D.js";import"./chevron-up-BNUmGYtt.js";import"./index-Cgj0PMn7.js";function Z(u){const p=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,l=u.match(p);return l&&l[2].length===11?l[2]:""}const $=50*1024*1024;function ze({setOpen:u,onAdd:p}){const[l,v]=s.useState(""),[r,g]=s.useState("text"),[k,w]=s.useState(""),[L,h]=s.useState(""),[x,y]=s.useState(!1),[N,F]=s.useState(""),[o,z]=s.useState(""),[i,f]=s.useState(null),[S,M]=s.useState(""),[C,E]=s.useState(0),[q,_]=s.useState(0),[b,j]=s.useState(!0),D=s.useRef(null),U=t=>{var c;if(t.preventDefault(),!l.trim()){h("Judul materi harus diisi"),(c=D.current)==null||c.focus();return}p({title:l,type:r,description:k,is_free:x,content:r==="text"?N:void 0,video_url:r==="video"?o:void 0,attachment:r==="file"?i:void 0,quizzes:r==="quiz"?[{instructions:S,time_limit:C,passing_score:q}]:void 0,is_preview:b}),v(""),w(""),g("text"),F(""),z(""),f(null),y(!1),j(!0),h("")};return e.jsxs(B,{children:[e.jsx(Q,{children:"Tambah Materi"}),e.jsx(V,{children:"Masukkan judul, tipe, dan deskripsi materi."}),e.jsxs("form",{className:"space-y-6",onSubmit:U,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"title",className:"sr-only",children:"Judul Materi"}),e.jsx(m,{id:"title",type:"text",name:"title",ref:D,value:l,onChange:t=>v(t.target.value),placeholder:"Judul Materi",autoComplete:"off"}),e.jsx(R,{message:L}),e.jsx(a,{htmlFor:"description",className:"sr-only",children:"Deskripsi Materi"}),e.jsx(I,{id:"description",name:"description",value:k,onChange:t=>w(t.target.value),placeholder:"Deskripsi Materi (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(a,{htmlFor:"type",className:"sr-only",children:"Tipe Materi"}),e.jsxs(A,{value:r,onValueChange:t=>g(t),children:[e.jsx(J,{children:e.jsx(K,{placeholder:"Pilih tipe materi"})}),e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(d,{value:"text",children:"Text"}),e.jsx(d,{value:"video",children:"Video"}),e.jsx(d,{value:"file",children:"File"}),e.jsx(d,{value:"quiz",children:"Quiz"})]})})]}),r==="text"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"content",className:"mb-1 block text-sm font-medium",children:"Konten Materi"}),e.jsx(G,{apiKey:"ezdq40mjneld4d8pnta3pfr55y39ttbvvtyp6xrhqswrefxz",value:N,onEditorChange:t=>F(t),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],onboarding:!1,toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",tinycomments_mode:"embedded",tinycomments_author:"Author name",mergetags_list:[{value:"First.Name",title:"First Name"},{value:"Email",title:"Email"}],height:300}})]}),r==="video"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"video-link",className:"mb-1 block text-sm font-medium",children:"Link YouTube Video"}),e.jsx(m,{id:"video-link",type:"text",placeholder:"https://www.youtube.com/watch?v=xxxxxx",value:o,onChange:t=>z(t.target.value),autoComplete:"off"}),o&&o.trim()!==""&&e.jsx("div",{className:"mt-2",children:e.jsx("iframe",{className:"rounded border",width:"100%",height:"250",src:o.includes("youtube.com")||o.includes("youtu.be")?`https://www.youtube.com/embed/${Z(o)}`:"",title:"YouTube Preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),r==="file"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"attachment",className:"mb-1 block text-sm font-medium",children:"Upload File (Format PDF, DOCX, XLSX, PPTX)"}),e.jsx(m,{id:"attachment",type:"file",onChange:t=>{var c;const n=((c=t.target.files)==null?void 0:c[0])??null;if(n&&n.size>$){h("Ukuran file maksimal 50 MB"),f(null);return}f(n),n&&n.type!=="application/pdf"&&j(!1)}}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(T,{id:"is-preview",checked:b,onCheckedChange:i&&i.type!=="application/pdf"?void 0:j,className:i&&i.type!=="application/pdf"?"opacity-50 cursor-not-allowed":""}),e.jsx(a,{htmlFor:"is-preview",className:i&&i.type!=="application/pdf"?"text-muted-foreground":"",children:b?"File hanya bisa dilihat (preview)":"File bisa di-download"})]}),i&&i.type!=="application/pdf"&&e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"Preview hanya tersedia untuk file PDF. File non-PDF otomatis bisa di-download."}),i&&e.jsxs("div",{className:"mt-2 rounded border p-2",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"font-medium",children:"File:"}),e.jsx("span",{children:i.name}),e.jsxs("span",{children:["(",Math.round(i.size/1024)," KB)"]}),i.type==="application/pdf"&&e.jsx("a",{href:URL.createObjectURL(i),target:"_blank",rel:"noopener noreferrer",className:"ml-auto rounded bg-black/60 px-2 py-1 text-xs text-white hover:bg-black/80",title:"Tampilkan Fullscreen",children:"Fullscreen"})]}),i.type==="application/pdf"?e.jsx("object",{data:URL.createObjectURL(i),type:"application/pdf",width:"100%",height:"200px",children:e.jsxs("p",{children:["Preview tidak tersedia."," ",e.jsx("a",{href:URL.createObjectURL(i),target:"_blank",rel:"noopener noreferrer",children:"Download PDF"})]})}):e.jsx("div",{className:"text-xs text-muted-foreground italic",children:"Preview hanya tersedia untuk file PDF."})]})]}),r==="quiz"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"quiz-instructions",className:"sr-only",children:"Instruksi Quiz"}),e.jsx(I,{id:"quiz-instructions",name:"quiz-instructions",value:S,onChange:t=>M(t.target.value),placeholder:"Instruksi untuk quiz (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(a,{htmlFor:"quiz-time-limit",className:"mb-1 block text-sm font-medium",children:"Time Limit (menit)"}),e.jsx(m,{id:"quiz-time-limit",type:"number",min:0,placeholder:"0 (tanpa batas waktu)",value:C,onChange:t=>E(Number(t.target.value))}),e.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:["Isi ",e.jsx("span",{className:"font-bold",children:"0"})," jika quiz tidak memiliki batas waktu"]}),e.jsx(a,{htmlFor:"quiz-passing-score",className:"mb-1 block text-sm font-medium",children:"Passing Score"}),e.jsx(m,{id:"quiz-passing-score",type:"number",min:0,max:100,placeholder:"Nilai minimal lulus (0-100)",value:q,onChange:t=>_(Number(t.target.value))}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Simpan quiz terlebih dahulu. Untuk mengakses soal-soal, silahkan mengkases melalui detail kelas."})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(T,{id:"is-free",checked:x,onCheckedChange:y}),e.jsx(a,{htmlFor:"is-free",children:x?"Materi ini gratis":"Materi ini berbayar"})]})]}),e.jsxs(X,{className:"gap-2",children:[e.jsx(O,{asChild:!0,children:e.jsx(P,{variant:"secondary",onClick:()=>u(!1),className:"hover:cursor-pointer",children:"Batal"})}),e.jsx(P,{type:"submit",className:"hover:cursor-pointer",children:"Tambah Materi"})]})]})]})}export{ze as default};
