import{r as i,m as M,j as e}from"./app-BCQAouuw.js";import{I as v}from"./input-error-CWZiurb1.js";import{B as D}from"./button-DXP6Q-wK.js";import{c as R,d as U,e as J,f as L}from"./dialog-CoH3gsXb.js";import{I as _}from"./input-AFx9Uce7.js";import{L as N}from"./label-BprQ5Y9K.js";import{t as g}from"./index-BYfPN2xp.js";import"./utils-C5uPrUnR.js";import"./index-CJ4J6dKF.js";import"./index-CUHDoZby.js";import"./index-CfPVAXCn.js";import"./index-Bksihhv_.js";import"./Combination-BcTXxegO.js";import"./x-BaSYQBEZ.js";import"./createLucideIcon-CpwwlDj_.js";function re({design:r,setOpen:k}){const P=i.useRef(null),E=i.useRef(null),G=i.useRef(null),[u,c]=i.useState(null),[p,d]=i.useState(null),[I,x]=i.useState(!1),[C,h]=i.useState(!1),{data:l,setData:s,post:T,processing:y,reset:F,errors:j,clearErrors:f}=M({name:r.name,image_1:null,image_2:null,_method:"PUT"});i.useEffect(()=>{s({name:r.name,image_1:null,image_2:null,_method:"PUT"}),f(),c(null),d(null)},[r,s,f]);const w=m=>{m.preventDefault();const a=new FormData;a.append("name",l.name),a.append("_method","PUT"),l.image_1&&a.append("image_1",l.image_1),l.image_2&&a.append("image_2",l.image_2),T(route("certificate-designs.update",r.id),{preserveScroll:!0,onSuccess:()=>{k(!1),F(),f(),c(null),d(null)},onError:()=>{var t;return(t=P.current)==null?void 0:t.focus()}})},B=m=>{var t;const a=((t=m.target.files)==null?void 0:t[0])??null;if(a){if(!["image/png","image/jpeg","image/jpg"].includes(a.type)){x(!0),s("image_1",null),g("Gambar harus png, jpg, atau jpeg");return}if(a.size>2*1024*1024){x(!0),s("image_1",null),g("Ukuran file maksimal 2MB!");return}}if(x(!1),s("image_1",a),a){const n=new FileReader;n.onload=b=>{var o;return c((o=b.target)==null?void 0:o.result)},n.readAsDataURL(a)}else c(null)},S=m=>{var t;const a=((t=m.target.files)==null?void 0:t[0])??null;if(a){if(!["image/png","image/jpeg","image/jpg"].includes(a.type)){h(!0),s("image_2",null),g("Gambar harus png, jpg, atau jpeg");return}if(a.size>2*1024*1024){h(!0),s("image_2",null),g("Ukuran file maksimal 2MB!");return}}if(h(!1),s("image_2",a),a){const n=new FileReader;n.onload=b=>{var o;return d((o=b.target)==null?void 0:o.result)},n.readAsDataURL(a)}else d(null)};return e.jsxs(e.Fragment,{children:[e.jsx(R,{children:"Edit Desain Sertifikat"}),e.jsx(U,{children:"Ubah nama atau gambar desain sertifikat."}),e.jsxs("form",{className:"space-y-4",onSubmit:w,children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"name",children:"Nama Desain"}),e.jsx(_,{id:"name",type:"text",name:"name",ref:P,value:l.name,onChange:m=>s("name",m.target.value),placeholder:"Masukkan nama desain",autoComplete:"off",required:!0}),e.jsx(v,{message:j.name})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"image_1",children:"Gambar 1"}),e.jsxs("div",{className:"my-2 flex gap-4",children:[r.image_1&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:`/storage/${r.image_1}`,alt:"Current Image 1",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Gambar saat ini"})]}),u&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:u,alt:"Preview Image 1",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"mt-1 text-xs text-green-600",children:"Gambar baru"})]}),!r.image_1&&!u&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/assets/images/placeholder.png",alt:"Placeholder",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Tidak ada gambar"})]})]}),e.jsx(_,{id:"image_1",type:"file",name:"image_1",ref:E,accept:"image/png, image/jpeg, image/jpg",className:I?"border-red-500 focus-visible:ring-red-500":"",onChange:B}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Biarkan kosong jika tidak ingin mengubah gambar. Format: JPEG, PNG, JPG. Maksimal 2MB."}),e.jsx(v,{message:j.image_1})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"image_2",children:"Gambar 2 (Opsional)"}),e.jsxs("div",{className:"my-2 flex gap-4",children:[r.image_2&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:`/storage/${r.image_2}`,alt:"Current Image 2",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Gambar saat ini"})]}),p&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:p,alt:"Preview Image 2",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"mt-1 text-xs text-green-600",children:"Gambar baru"})]}),!r.image_2&&!p&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:"/assets/images/placeholder.png",alt:"Placeholder",className:"h-24 rounded border object-cover"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Tidak ada gambar"})]})]}),e.jsx(_,{id:"image_2",type:"file",name:"image_2",ref:G,accept:"image/png, image/jpeg, image/jpg",className:C?"border-red-500 focus-visible:ring-red-500":"",onChange:S}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:"Biarkan kosong jika tidak ingin mengubah gambar. Format: JPEG, PNG, JPG. Maksimal 2MB."}),e.jsx(v,{message:j.image_2})]})]}),e.jsxs(J,{className:"gap-2",children:[e.jsx(L,{asChild:!0,children:e.jsx(D,{variant:"secondary",onClick:()=>k(!1),className:"hover:cursor-pointer",children:"Batal"})}),e.jsx(D,{disabled:y,asChild:!0,className:"hover:cursor-pointer",children:e.jsx("button",{type:"submit",children:y?"Menyimpan...":"Simpan Perubahan"})})]})]})]})}export{re as default};
