import{j as e,r as w,L as P,$ as d}from"./app-BCQAouuw.js";import{c as T}from"./index-CUHDoZby.js";import{c as _}from"./utils-C5uPrUnR.js";import{A as I,a as A,b as R,c as B,d as z,e as F,f as E,g as O,h as $}from"./alert-dialog-iNIXOCb5.js";import{B as r}from"./button-DXP6Q-wK.js";import{U as K}from"./user-layout-BHwedF5z.js";import{t as o}from"./index-BYfPN2xp.js";import{E as N}from"./external-link-DLZqqP-M.js";import{C as k}from"./clock-CbDez9Mm.js";import{C as m}from"./circle-x-DeypmIV0.js";import{F as M}from"./file-text-C0XuMPNK.js";import{H}from"./house-CioRMPCe.js";import{T as U}from"./triangle-alert-B3F4l-S5.js";import{C as V}from"./circle-check-big-BIlIeQar.js";import"./index-CfPVAXCn.js";import"./index-Bksihhv_.js";import"./index-CJ4J6dKF.js";import"./Combination-BcTXxegO.js";import"./sonner-DNRlwVFm.js";import"./breadcrumbs-D_BbBpYK.js";import"./createLucideIcon-CpwwlDj_.js";import"./x-BaSYQBEZ.js";import"./tooltip-DITUUh-o.js";import"./index-ia4IXwrZ.js";import"./index-IYjuPMHC.js";import"./floating-ui.react-dom-CIa1FZ6R.js";import"./index-BCCJhP44.js";import"./index-DYzEDVxC.js";import"./dropdown-menu-C-0ZxPQ9.js";import"./index-DLjS3uAJ.js";import"./circle-Ce0Ea8_f.js";import"./user-DnsLu74L.js";import"./chevron-right-DVkZ2REO.js";import"./mail-Cp2F3vNV.js";import"./phone-DaAzxi5q.js";import"./icon-DqevJFCQ.js";import"./index-WGLdZ-ay.js";import"./monitor-play-BOGPVpyV.js";const X=T("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function c({className:a,variant:l,...i}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:_(X({variant:l}),a),...i})}function x({className:a,...l}){return e.jsx("div",{"data-slot":"alert-description",className:_("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...l})}function Ae({invoice:a}){var f,j,b;const[l,i]=w.useState(!1),[D,u]=w.useState(!1),n=a.expires_at&&new Date>new Date(a.expires_at),h=a.expires_at?new Date(a.expires_at).getTime()-new Date().getTime():0,C=Math.floor(h/(1e3*60*60)),v=Math.floor(h%(1e3*60*60)/(1e3*60)),t=(()=>{if(a.course_items&&a.course_items.length>0){const s=a.course_items[0].course;return{type:"course",name:s.title,slug:s.slug,thumbnail:s.thumbnail,profileRoute:"profile.course.detail",publicRoute:"course.detail"}}else if(a.webinar_items&&a.webinar_items.length>0){const s=a.webinar_items[0].webinar;return{type:"webinar",name:s.title,slug:s.slug,thumbnail:s.thumbnail,profileRoute:"profile.webinar.detail",publicRoute:"webinar.detail"}}return null})(),S=async()=>{var s;i(!0),u(!1);try{const y=await(await fetch(route("invoice.cancel",{id:a.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content)||""}})).json();y.success?(o.success("Pesanan berhasil dibatalkan dan invoice telah dinonaktifkan."),window.location.reload()):o.error(y.message||"Gagal membatalkan pesanan.")}catch{o.error("Terjadi kesalahan saat membatalkan pesanan.")}finally{i(!1)}},L=()=>{switch(a.status){case"paid":return e.jsx(V,{className:"mt-1 h-6 w-6 text-green-500"});case"pending":return e.jsx(k,{className:"mt-1 h-6 w-6 text-yellow-500"});case"failed":return e.jsx(m,{className:"mt-1 h-6 w-6 text-red-500"});default:return e.jsx(U,{className:"mt-1 h-6 w-6 text-gray-500"})}},g=()=>{switch(a.status){case"paid":return"Pembayaran Berhasil";case"pending":return n?"Pembayaran Kedaluwarsa":"Menunggu Pembayaran";case"failed":return"Pembayaran Dibatalkan";default:return"Status Tidak Diketahui"}},p=()=>{switch(a.status){case"paid":return"text-green-600";case"pending":return n?"text-red-600":"text-yellow-600";case"failed":return"text-red-600";default:return"text-gray-600"}};return e.jsxs(K,{children:[e.jsx(P,{title:`Invoice ${a.invoice_code}`}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-4 md:py-8 dark:bg-gray-900",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4",children:e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-lg dark:bg-gray-800",children:[e.jsxs("div",{className:"to-primary flex gap-3 bg-gradient-to-tl from-black px-6 py-4 text-white",children:[L(),e.jsxs("div",{children:[e.jsx("h1",{className:`text-xl font-bold md:text-2xl ${p()}`,children:g()}),e.jsxs("p",{className:"mt-1 text-sm text-blue-100 md:text-base",children:["Invoice #",a.invoice_code]})]})]}),e.jsxs("div",{className:"p-6",children:[t&&e.jsxs("div",{className:"mb-6 rounded-lg border bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-700",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Produk yang Dibeli"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:t.thumbnail?`/storage/${t.thumbnail}`:"/assets/images/placeholder.png",alt:t.name,className:"h-16 rounded-lg object-cover md:h-20"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 capitalize dark:text-gray-400",children:t.type==="course"?"Kelas Online":"Webinar"}),e.jsx("div",{className:"mt-2 flex flex-col gap-2 sm:flex-row",children:a.status==="paid"?e.jsx(r,{asChild:!0,size:"sm",variant:"outline",children:e.jsxs(d,{href:route(t.profileRoute,{[t.type]:t.slug}),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Buka di Profile"]})}):e.jsx(r,{asChild:!0,size:"sm",variant:"ghost",children:e.jsxs(d,{href:route(t.publicRoute,{[t.type]:t.slug}),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Lihat Detail Produk"]})})})]})]})]}),a.status==="pending"&&!n&&e.jsxs(c,{className:"mb-6 border-yellow-200 bg-yellow-50",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx(x,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Pembayaran akan kedaluwarsa dalam ",C," jam ",v," menit."]})})})]}),a.status==="pending"&&n&&e.jsxs(c,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx(x,{children:"Invoice ini sudah kedaluwarsa dan tidak dapat dibayar lagi. Silakan buat pesanan baru."})]}),a.status==="failed"&&e.jsxs(c,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx(x,{children:"Invoice ini telah dibatalkan dan tidak dapat dibayar lagi. Silakan buat pesanan baru jika masih ingin membeli."})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Detail Pembayaran"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.discount_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Harga Asli:"}),e.jsxs("span",{className:"medium",children:["Rp ",(f=a.discount_amount)==null?void 0:f.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),e.jsxs("span",{className:"text-gray-500 line-through",children:["Rp ",(a.discount_amount-a.nett_amount).toLocaleString("id-ID")||"0"]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),e.jsxs("span",{className:"font-medium",children:["Rp ",((j=a.nett_amount)==null?void 0:j.toLocaleString("id-ID"))||"0"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Biaya Transaksi:"}),e.jsxs("span",{className:"font-medium",children:["Rp ",((a.amount||0)-(a.nett_amount||0)).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 text-lg font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["Rp ",((b=a.amount)==null?void 0:b.toLocaleString("id-ID"))||"0"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Informasi Pembayaran"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-medium ${p()}`,children:g()})]}),a.payment_method&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Metode:"}),e.jsx("span",{className:"font-medium",children:a.payment_method})]}),a.payment_channel&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Channel:"}),e.jsx("span",{className:"font-medium",children:a.payment_channel})]}),a.paid_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Dibayar pada:"}),e.jsx("span",{className:"font-medium",children:new Date(a.paid_at).toLocaleString("id-ID")})]}),a.expires_at&&a.status==="pending"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Kedaluwarsa:"}),e.jsx("span",{className:"font-medium",children:new Date(a.expires_at).toLocaleString("id-ID")})]})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center gap-4 sm:flex-row",children:[a.status==="pending"&&!n&&a.invoice_url&&e.jsxs(e.Fragment,{children:[e.jsx(r,{asChild:!0,size:"lg",className:"w-full sm:w-auto",children:e.jsx("a",{href:a.invoice_url,target:"_blank",rel:"noopener noreferrer",children:"Lanjutkan Pembayaran"})}),e.jsxs(I,{open:D,onOpenChange:u,children:[e.jsx(A,{asChild:!0,children:e.jsx(r,{variant:"outline",size:"lg",className:"w-full border-red-600 text-red-600 hover:bg-red-50 sm:w-auto",disabled:l,children:l?"Membatalkan...":"Batalkan Pesanan"})}),e.jsxs(R,{children:[e.jsxs(B,{children:[e.jsx(z,{children:"Batalkan Pesanan?"}),e.jsx(F,{children:"Apakah Anda yakin ingin membatalkan pesanan ini? Invoice akan dinonaktifkan dan tidak dapat dibayar lagi. Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(E,{children:[e.jsx(O,{children:"Tidak, Pertahankan"}),e.jsx($,{onClick:S,className:"border-red-600 bg-red-600 hover:bg-red-700",children:"Ya, Batalkan Pesanan"})]})]})]})]}),a.status==="paid"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{asChild:!0,className:"w-full sm:w-auto",variant:"outline",children:e.jsx(d,{href:route("profile.transactions"),children:"Lihat Riwayat Transaksi"})}),e.jsx(r,{asChild:!0,children:e.jsxs("a",{href:route("invoice.pdf",{id:a.id}),target:"_blank",rel:"noopener noreferrer",children:[e.jsx(M,{className:"size-4"}),"Unduh Invoice"]})})]}),(a.status==="failed"||n)&&e.jsx(r,{asChild:!0,size:"lg",className:"w-full sm:w-auto",children:e.jsxs(d,{href:route("home"),children:[e.jsx(H,{})," Kembali ke Beranda"]})})]})]})]})})})]})}export{Ae as default};
