import{K as J,r as i,j as e,L as _,$ as B}from"./app-k8zswjN4.js";import{B as o}from"./button-DXavOchq.js";import{C as Q}from"./checkbox-Ck3k7HZB.js";import{I as j}from"./input-Dxh7gntF.js";import{L as h}from"./label-C9tmqixz.js";import{S as U}from"./separator-BypEpIKP.js";import{U as v}from"./user-layout-Dpx_9Ala.js";import{U as E}from"./user-CuHVlf3H.js";import{B as V}from"./badge-check-Cr1EfBwO.js";import{H as Y}from"./hourglass-BIdAY9bx.js";import{C as W}from"./index-BV5r0t8n.js";import{X as Z}from"./x-Brw5WuUb.js";import"./index-yeKsPfmp.js";import"./index-pHOxZwLY.js";import"./utils-CkV0Qb-V.js";import"./index-DBFJEYa8.js";import"./index-D6V9crY2.js";import"./index-6vY0h7jb.js";import"./floating-ui.react-dom-CRZWRie3.js";import"./index-Bxzk6A-r.js";import"./index-B-dSN1WG.js";import"./sonner-CTwMjNNw.js";import"./index-D_K9UrkW.js";import"./breadcrumbs-BRc7dmCI.js";import"./createLucideIcon-D-iNy-Um.js";import"./index-pXs-r0Ho.js";import"./Combination-BrdjsB_W.js";import"./tooltip-Bn_vQ-Xo.js";import"./index-DQoMunvF.js";import"./dropdown-menu-BMlwBcR9.js";import"./circle-I3bKzACo.js";import"./chevron-right-D9DydK3z.js";import"./mail-B2Yeqegj.js";import"./phone-BA-Op-_N.js";import"./icon-CyrjpY36.js";import"./house-BLwYiQvp.js";import"./monitor-play-BbbNWAOL.js";function Ue({webinar:a,hasAccess:K,pendingInvoiceUrl:S,referralInfo:c}){var I;const{auth:C}=J().props,T=!!C.user,P=T&&((I=C.user)==null?void 0:I.phone_number),[k,O]=i.useState(!1),[f,u]=i.useState(!1),[d,q]=i.useState(""),[t,g]=i.useState(null),[F,L]=i.useState(!1),[y,p]=i.useState(""),[H,A]=i.useState(!1),[m,N]=i.useState({ig_follow_proof:null,tag_friend_proof:null,tiktok_follow_proof:null}),n=a.price===0,b=5e3,G=a.price,M=(t==null?void 0:t.discount_amount)||0,D=G-M,R=n?0:D+b;i.useEffect(()=>{const r=new URLSearchParams(window.location.search).get("ref");r?sessionStorage.setItem("referral_code",r):c.code&&sessionStorage.setItem("referral_code",c.code)},[c]),i.useEffect(()=>{if(!d.trim()||n){g(null),p("");return}const s=setTimeout(()=>{$()},500);return()=>clearTimeout(s)},[d]);const $=async()=>{var s;if(!(!d.trim()||n)){L(!0),p("");try{const l=await(await fetch("/api/discount-codes/validate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content)||""},credentials:"same-origin",body:JSON.stringify({code:d,amount:a.price,product_type:"webinar",product_id:a.id})})).json();l.valid?(g(l),p("")):(g(null),p(l.message||"Kode promo tidak valid"))}catch{g(null),p("Terjadi kesalahan saat memvalidasi kode promo")}finally{L(!1)}}},z=async s=>{var l;if(s.preventDefault(),!m.ig_follow_proof||!m.tag_friend_proof||!m.tiktok_follow_proof){alert("Harap upload semua bukti follow dan tag yang diperlukan!");return}u(!0);const r=new FormData;r.append("type","webinar"),r.append("id",a.id),r.append("ig_follow_proof",m.ig_follow_proof),r.append("tag_friend_proof",m.tag_friend_proof||""),r.append("tiktok_follow_proof",m.tiktok_follow_proof);try{const w=await fetch(route("enroll.free"),{method:"POST",headers:{"X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.content)||""},body:r}),x=await w.json();w.ok&&x.redirect_url?window.location.href=x.redirect_url:alert(x.message||"Gagal mendaftar webinar gratis.")}catch{alert("Terjadi kesalahan saat proses pendaftaran.")}finally{u(!1)}},X=async s=>{var r;if(s.preventDefault(),!P){alert("Profil Anda belum lengkap! Harap lengkapi nomor telepon terlebih dahulu."),window.location.href=route("profile.edit");return}if(!k&&!n){alert("Anda harus menyetujui syarat dan ketentuan!");return}if(u(!0),n){A(!0),u(!1);return}try{const l={type:"webinar",id:a.id,discount_amount:a.strikethrough_price||0,nett_amount:D,transaction_fee:b,total_amount:R};t!=null&&t.valid&&(l.discount_code_id=t.discount_code.id,l.discount_code_amount=t.discount_amount);const x=await(await fetch(route("invoice.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.content)||""},credentials:"same-origin",body:JSON.stringify(l)})).json();x.url?window.location.href=x.url:alert("Gagal membuat invoice.")}catch{alert("Terjadi kesalahan saat proses pembayaran.")}finally{u(!1)}};if(!T){const s=window.location.href,r=route("login",{redirect:s});return e.jsxs(v,{children:[e.jsx(_,{title:"Login Required"}),e.jsx("section",{className:"to-tertiary from-primary w-full bg-gradient-to-br px-4",children:e.jsxs("div",{className:"mx-auto my-18 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl text-center text-3xl font-bold text-white sm:text-4xl",children:['Daftar Webinar "',a.title,'"']}),e.jsx("img",{src:a.thumbnail?`/storage/${a.thumbnail}`:"/assets/images/placeholder.png",alt:a.title,className:"mx-auto my-6 w-full max-w-xl rounded-lg border border-gray-200 shadow-md"}),e.jsx("p",{className:"text-center text-gray-200",children:"Silakan login terlebih dahulu untuk mendaftar webinar."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(E,{size:64,className:"text-blue-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Login Diperlukan"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Anda perlu login terlebih dahulu untuk mendaftar webinar ini.",c.hasActive&&" Kode referral Anda akan tetap tersimpan."]}),e.jsxs("div",{className:"flex w-full max-w-md gap-2",children:[e.jsx(o,{asChild:!0,className:"flex-1",children:e.jsx("a",{href:r,children:"Login"})}),e.jsx(o,{asChild:!0,variant:"outline",className:"flex-1",children:e.jsx(B,{href:route("register",c.code?{ref:c.code}:{}),children:"Daftar"})})]})]})})]})}return P?e.jsxs(v,{children:[e.jsx(_,{title:"Daftar Webinar"}),e.jsx("section",{className:"to-tertiary from-primary w-full bg-gradient-to-br px-4",children:e.jsxs("div",{className:"mx-auto my-18 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl text-center text-3xl font-bold text-white sm:text-4xl",children:['Daftar Webinar "',a.title,'"']}),e.jsx("img",{src:a.thumbnail?`/storage/${a.thumbnail}`:"/assets/images/placeholder.png",alt:a.title,className:"mx-auto my-6 w-full max-w-xl rounded-lg border border-gray-200 shadow-md"}),e.jsx("p",{className:"text-center text-gray-200",children:n?"Silahkan lengkapi persyaratan berikut untuk mendaftar webinar.":"Silakan selesaikan pembayaran untuk mendaftar webinar."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsx("div",{className:"w-full",children:K?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(V,{size:64,className:"text-green-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Anda Sudah Memiliki Akses"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda sudah terdaftar di webinar ini. Silakan masuk ke dalam grup."}),e.jsx(o,{asChild:!0,className:"w-full",children:e.jsx("a",{href:a.group_url??"",target:"_blank",rel:"noopener noreferrer",children:"Masuk Group Webinar"})})]}):S?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(Y,{size:64,className:"text-yellow-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Pembayaran Tertunda"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda memiliki pembayaran yang belum selesai untuk webinar ini. Silakan lanjutkan untuk membayar."}),e.jsx(o,{asChild:!0,className:"w-full",children:e.jsx("a",{href:S,children:"Lanjutkan Pembayaran"})})]}):H?e.jsxs("form",{onSubmit:z,children:[e.jsx("h2",{className:"my-2 text-xl font-bold",children:"Upload Bukti Follow"}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Bukti Follow Instagram"}),e.jsx(j,{type:"file",accept:"image/*",onChange:s=>N(r=>{var l;return{...r,ig_follow_proof:((l=s.target.files)==null?void 0:l[0])||null}}),required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot halaman profil Instagram kami yang menunjukkan Anda sudah follow"})]}),e.jsxs("div",{children:[e.jsx(h,{children:"Bukti Follow TikTok"}),e.jsx(j,{type:"file",accept:"image/*",onChange:s=>N(r=>{var l;return{...r,tiktok_follow_proof:((l=s.target.files)==null?void 0:l[0])||null}}),required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot halaman profil TikTok kami yang menunjukkan Anda sudah follow"})]}),e.jsxs("div",{children:[e.jsx(h,{children:"Bukti Tag 3 Teman di Instagram"}),e.jsx(j,{type:"file",accept:"image/*",onChange:s=>N(r=>{var l;return{...r,tag_friend_proof:((l=s.target.files)==null?void 0:l[0])||null}}),required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot postingan Instagram kami yang menunjukkan Anda sudah tag 3 teman di komentar"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>A(!1),className:"flex-1",children:"Kembali"}),e.jsx(o,{type:"submit",disabled:f,className:"flex-1",children:f?"Memproses...":"Dapatkan Akses Gratis"})]})]})]}):e.jsxs("form",{onSubmit:X,children:[e.jsxs("h2",{className:"my-2 text-xl font-bold",children:["Detail ",n?"Pendaftaran":"Pembayaran"]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[n?e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("div",{className:"flex items-center justify-between p-4",children:e.jsx("span",{className:"w-full text-2xl font-bold text-green-600",children:"WEBINAR GRATIS"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Untuk mendapatkan akses gratis, Anda perlu:"}),e.jsxs("ul",{className:"space-y-1 text-left text-sm",children:[e.jsxs("li",{children:["• Follow Instagram kami"," ",e.jsx("a",{href:"https://www.instagram.com/arsacendekia/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"@arsacendekia"})]}),e.jsxs("li",{children:["• Follow TikTok kami"," ",e.jsx("a",{href:"https://www.tiktok.com/@arsacendekia",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"@arsacendekia"})]}),e.jsx("li",{children:"• Tag 3 teman di postingan Instagram kami"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload bukti follow dan tag untuk mendapatkan akses"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"promo-code",children:"Kode Promo (Opsional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{id:"promo-code",type:"text",placeholder:"Masukkan kode promo",value:d,onChange:s=>q(s.target.value.toUpperCase()),className:"pr-10"}),F&&e.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-blue-600"})}),!F&&d&&e.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:t!=null&&t.valid?e.jsx(W,{className:"h-4 w-4 text-green-600"}):y?e.jsx(Z,{className:"h-4 w-4 text-red-600"}):null})]}),y&&e.jsx("p",{className:"text-sm text-red-600",children:y}),(t==null?void 0:t.valid)&&e.jsxs("div",{className:"rounded-lg border border-green-200 bg-green-50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-green-600"}),e.jsxs("p",{className:"text-sm font-medium text-green-800",children:['Kode promo "',t.discount_code.code,'" berhasil diterapkan!']})]}),e.jsxs("p",{className:"mt-1 text-xs text-green-600",children:[t.discount_code.name," - Diskon ",t.discount_code.formatted_value]})]})]}),e.jsxs("div",{className:"space-y-2 rounded-lg border p-4",children:[a.strikethrough_price>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Asli"}),e.jsxs("span",{className:"font-semibold text-gray-500 line-through",children:["Rp ",a.strikethrough_price.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Diskon"}),e.jsxs("span",{className:"font-semibold text-red-500",children:["-Rp ",(a.strikethrough_price-a.price).toLocaleString("id-ID")]})]}),e.jsx(U,{className:"my-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Webinar"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",a.price.toLocaleString("id-ID")]})]}),(t==null?void 0:t.valid)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:["Diskon Promo (",t.discount_code.code,")"]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["-Rp ",t.discount_amount.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Biaya Transaksi"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",b.toLocaleString("id-ID")]})]}),e.jsx(U,{className:"my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Total Pembayaran"}),e.jsxs("span",{className:"text-primary text-xl font-bold",children:["Rp ",R.toLocaleString("id-ID")]})]})]})]}),!n&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{id:"terms",checked:k,onCheckedChange:s=>O(s===!0)}),e.jsxs(h,{htmlFor:"terms",children:["Saya menyetujui"," ",e.jsx("a",{href:"/terms-and-conditions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-700 hover:underline",children:"syarat dan ketentuan"})]})]}),e.jsx(o,{className:"w-full",type:"submit",disabled:(n?!1:!k)||f,children:f?"Memproses...":n?"Upload Bukti Follow":"Lanjutkan Pembayaran"})]})]})})})]}):e.jsxs(v,{children:[e.jsx(_,{title:"Daftar Webinar"}),e.jsx("section",{className:"to-tertiary from-primary w-full bg-gradient-to-br px-4",children:e.jsxs("div",{className:"mx-auto my-18 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl text-center text-3xl font-bold text-white sm:text-4xl",children:['Daftar Webinar "',a.title,'"']}),e.jsx("img",{src:a.thumbnail?`/storage/${a.thumbnail}`:"/assets/images/placeholder.png",alt:a.title,className:"mx-auto my-6 w-full max-w-xl rounded-lg border border-gray-200 shadow-md"}),e.jsx("p",{className:"text-center text-gray-200",children:"Silakan lengkapi profil Anda terlebih dahulu."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(E,{size:64,className:"text-orange-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Profil Belum Lengkap"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Profil Anda belum lengkap! Harap lengkapi nomor telepon terlebih dahulu untuk mendaftar webinar."}),e.jsx(o,{asChild:!0,className:"w-full max-w-md",children:e.jsx(B,{href:route("profile.edit",{redirect:window.location.href}),children:"Lengkapi Profil"})})]})})]})}export{Ue as default};
