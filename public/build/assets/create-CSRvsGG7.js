import{r as N,j as e,L as ae,S as re}from"./app-0I1QzVTg.js";import{B as te}from"./badge-CjFQCB4e.js";import{B as u}from"./button-D2ZpcnoY.js";import{C as O}from"./calendar-C7CkyaD-.js";import{C as y}from"./checkbox-BahJMLR_.js";import{u as ne,F as ie,a as n,b as i,c as t,d as l,f as h,e as c}from"./form-B8Qa-gsK.js";import{I as x}from"./input-BEoPePt1.js";import{P as w,a as P,b as S}from"./popover-OVqhZvMy.js";import{S as M,a as V,b as A,c as B,d as g}from"./select-VJ5t5ozs.js";import{T as le}from"./textarea-BFAtLBqy.js";import{A as oe}from"./admin-layout-uhp-ZAsE.js";import{c as I}from"./utils-liWpcwDK.js";import{s as ce,o as L,a as R,d as de,f as z,n as f,e as me,b as p}from"./types-UNewp8nY.js";import{T as pe,P as ue}from"./tag-C9Li3RHo.js";import{S as he}from"./shuffle-BuPWGsx7.js";import{C as E}from"./calendar-ChXQrJJ2.js";import{C as J}from"./chevron-down-B9nJkVIc.js";import{P as xe}from"./plus-DnXklWU2.js";import{X as je}from"./x-C19WkH_u.js";import{f as U}from"./format-Bp4OdCl_.js";import{i as W}from"./id-Don4TG_0.js";import"./index-Bota6Y3-.js";import"./index-57D5-Vr4.js";import"./chevron-left-B3Wkr27h.js";import"./createLucideIcon-CstU9H3f.js";import"./chevron-right-c3YFH7gb.js";import"./index-BS3cphgy.js";import"./index-uHisoZSR.js";import"./index-D2fVTj-3.js";import"./floating-ui.react-dom-BJinGOXu.js";import"./index-ByifcKOL.js";import"./index-B7VqJuUm.js";import"./check-Bn2WpFkP.js";import"./label-B5pGucUU.js";import"./Combination-DeKqWJgp.js";import"./index-C2hMLgem.js";import"./chevron-up-B02KnPY6.js";import"./sonner-DAwbnb_L.js";import"./index-_fiB5kas.js";import"./breadcrumbs-D7kDS1RW.js";import"./index-gMo3zbQG.js";import"./tooltip-Bgr99O1S.js";import"./dropdown-menu-Ba8NYkgA.js";import"./circle-GcGN6Pbe.js";import"./user-DFjCH8AI.js";import"./app-sidebar-header-Bs1CQ6bQ.js";import"./chevrons-up-down-BUcrswdO.js";import"./user-check-CU66v9ir.js";import"./users-DxOrkHQM.js";import"./monitor-play-CKPUeDqI.js";import"./presentation-DuCFxc_8.js";import"./banknote-BUu1f0Ei.js";import"./dollar-sign-D30D1dLF.js";const ge=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Kode Diskon",href:"/admin/discount-codes"},{title:"Tambah Kode Diskon",href:"/admin/discount-codes/create"}],fe=L({code:p().min(1,"Kode diskon harus diisi").max(50,"Kode diskon maksimal 50 karakter"),name:p().min(1,"Nama diskon harus diisi").max(255,"Nama diskon maksimal 255 karakter"),description:p().optional(),type:me(["percentage","fixed"],{required_error:"Jenis diskon harus dipilih"}),value:f().min(1,"Nilai diskon harus lebih dari 0"),minimum_amount:f().optional(),usage_limit:f().optional(),usage_limit_per_user:f().optional(),starts_at:z({required_error:"Tanggal mulai harus dipilih"}),expires_at:z({required_error:"Tanggal berakhir harus dipilih"}),is_active:de(),applicable_types:R(p()).optional(),applicable_products:R(L({type:p(),id:p(),title:p(),price:f()})).optional()}).refine(d=>!(d.type==="percentage"&&d.value>100),{message:"Persentase tidak boleh lebih dari 100%",path:["value"]}).refine(d=>d.expires_at>d.starts_at,{message:"Tanggal berakhir harus setelah tanggal mulai",path:["expires_at"]});function fs({products:d}){const[q,T]=N.useState(!1),[X,D]=N.useState(!1),[G,K]=N.useState(!1),[_,H]=N.useState("course"),r=ne({resolver:ce(fe),defaultValues:{code:"",name:"",description:"",type:"percentage",value:10,minimum_amount:void 0,usage_limit:void 0,usage_limit_per_user:void 0,starts_at:new Date,expires_at:new Date(Date.now()+30*24*60*60*1e3),is_active:!0,applicable_types:[],applicable_products:[]}}),b=r.watch("type"),m=r.watch("applicable_types")||[],j=r.watch("applicable_products")||[],Q=()=>{const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let a="";for(let o=0;o<8;o++)a+=s.charAt(Math.floor(Math.random()*s.length));r.setValue("code",a)},C=(s,a)=>{const o=m;if(a)r.setValue("applicable_types",[...o,s]);else{r.setValue("applicable_types",o.filter(v=>v!==s));const k=j.filter(v=>v.type!==s);r.setValue("applicable_products",k)}},Y=(s,a)=>{const o={...s,type:a},k=j;k.some(F=>F.id===s.id&&F.type===a)||r.setValue("applicable_products",[...k,o]),K(!1)},Z=s=>{const a=j.filter(o=>!(o.id===s.id&&o.type===s.type));r.setValue("applicable_products",a)},$=()=>{switch(_){case"course":return d.courses;case"bootcamp":return d.bootcamps;case"webinar":return d.webinars;default:return[]}},ee=s=>{switch(s){case"course":return"Kelas";case"bootcamp":return"Bootcamp";case"webinar":return"Webinar";default:return s}};function se(s){const a={...s,description:s.description||null,minimum_amount:s.minimum_amount||null,usage_limit:s.usage_limit||null,usage_limit_per_user:s.usage_limit_per_user||null,applicable_types:s.applicable_types&&s.applicable_types.length>0?s.applicable_types:null,applicable_products:s.applicable_products&&s.applicable_products.length>0?s.applicable_products:null,starts_at:s.starts_at.toISOString(),expires_at:s.expires_at.toISOString()};re.post(route("discount-codes.store"),a)}return e.jsxs(oe,{breadcrumbs:ge,children:[e.jsx(ae,{title:"Tambah Kode Diskon"}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Tambah Kode Diskon"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:"Silakan isi form di bawah ini untuk membuat kode diskon baru. Pastikan semua informasi yang diperlukan telah diisi dengan benar."}),e.jsx(ie,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(se),className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:16}),e.jsx("h3",{className:"font-medium",children:"Informasi Dasar"})]}),e.jsx(n,{control:r.control,name:"code",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(t,{children:["Kode Diskon ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{children:e.jsx(x,{placeholder:"DISKON2024",...s,onChange:a=>s.onChange(a.target.value.toUpperCase()),className:"font-mono",autoComplete:"off"})}),e.jsx(u,{type:"button",variant:"outline",onClick:Q,children:e.jsx(he,{className:"h-4 w-4"})})]}),e.jsx(h,{children:"Kode unik untuk diskon ini (akan otomatis menjadi huruf besar)"}),e.jsx(c,{})]})}),e.jsx(n,{control:r.control,name:"name",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(t,{children:["Nama Diskon ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{children:e.jsx(x,{placeholder:"Diskon Tahun Baru",...s,autoComplete:"off"})}),e.jsx(c,{})]})}),e.jsx(n,{control:r.control,name:"description",render:({field:s})=>e.jsxs(i,{children:[e.jsx(t,{children:"Deskripsi"}),e.jsx(l,{children:e.jsx(le,{placeholder:"Deskripsi kode diskon...",...s,value:s.value||"",autoComplete:"off",rows:3})}),e.jsx(c,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 items-start gap-4",children:[e.jsx(n,{control:r.control,name:"type",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(t,{children:["Jenis Diskon ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(M,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(V,{children:e.jsx(A,{placeholder:"Pilih jenis diskon"})})}),e.jsxs(B,{children:[e.jsx(g,{value:"percentage",children:"Persentase (%)"}),e.jsx(g,{value:"fixed",children:"Nominal (Rp)"})]})]}),e.jsx(c,{})]})}),e.jsx(n,{control:r.control,name:"value",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(t,{children:["Nilai ",b==="percentage"?"Persentase":"Nominal"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{children:e.jsx(x,{type:"number",placeholder:b==="percentage"?"10":"50000",...s,onChange:a=>s.onChange(Number(a.target.value)),min:"1",max:b==="percentage"?100:void 0})}),e.jsx(h,{children:b==="percentage"?"Masukkan nilai 1-100":"Masukkan nominal dalam Rupiah"}),e.jsx(c,{})]})})]}),e.jsx(n,{control:r.control,name:"minimum_amount",render:({field:s})=>e.jsxs(i,{children:[e.jsx(t,{children:"Minimum Pembelian"}),e.jsx(l,{children:e.jsx(x,{type:"number",placeholder:"100000",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0),value:s.value||"",min:"0"})}),e.jsx(h,{children:"Kosongkan untuk tidak membatasi"}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{size:16}),e.jsx("h3",{className:"font-medium",children:"Penggunaan & Validitas"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{control:r.control,name:"usage_limit",render:({field:s})=>e.jsxs(i,{children:[e.jsx(t,{children:"Batas Penggunaan Total"}),e.jsx(l,{children:e.jsx(x,{type:"number",placeholder:"100",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0),value:s.value||"",min:"1"})}),e.jsx(h,{children:"Kosongkan untuk tidak membatasi"}),e.jsx(c,{})]})}),e.jsx(n,{control:r.control,name:"usage_limit_per_user",render:({field:s})=>e.jsxs(i,{children:[e.jsx(t,{children:"Batas Per User"}),e.jsx(l,{children:e.jsx(x,{type:"number",placeholder:"1",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0),value:s.value||"",min:"1"})}),e.jsx(h,{children:"Kosongkan untuk tidak membatasi"}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{control:r.control,name:"starts_at",render:({field:s})=>e.jsxs(i,{className:"flex flex-col",children:[e.jsxs(t,{children:["Tanggal Mulai ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{open:q,onOpenChange:T,children:[e.jsx(P,{asChild:!0,children:e.jsx(l,{children:e.jsxs(u,{variant:"outline",className:I("justify-between text-left font-normal",!s.value&&"text-muted-foreground"),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),s.value?U(s.value,"dd MMM yyyy",{locale:W}):"Pilih tanggal"]}),e.jsx(J,{className:"h-4 w-4"})]})})}),e.jsx(S,{className:"w-auto overflow-hidden p-0",align:"start",children:e.jsx(O,{mode:"single",selected:s.value,captionLayout:"dropdown",onSelect:a=>{a&&s.onChange(a),T(!1)},disabled:a=>a<new Date,initialFocus:!0})})]}),e.jsx(c,{})]})}),e.jsx(n,{control:r.control,name:"expires_at",render:({field:s})=>e.jsxs(i,{className:"flex flex-col",children:[e.jsxs(t,{children:["Tanggal Berakhir ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{open:X,onOpenChange:D,children:[e.jsx(P,{asChild:!0,children:e.jsx(l,{children:e.jsxs(u,{variant:"outline",className:I("justify-between text-left font-normal",!s.value&&"text-muted-foreground"),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),s.value?U(s.value,"dd MMM yyyy",{locale:W}):"Pilih tanggal"]}),e.jsx(J,{className:"h-4 w-4"})]})})}),e.jsx(S,{className:"w-auto overflow-hidden p-0",align:"start",children:e.jsx(O,{mode:"single",selected:s.value,captionLayout:"dropdown",onSelect:a=>{a&&s.onChange(a),D(!1)},disabled:a=>a<r.getValues("starts_at"),initialFocus:!0})})]}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(t,{children:"Berlaku Untuk Produk"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{id:"course",checked:m.includes("course"),onCheckedChange:s=>C("course",!!s)}),e.jsx(t,{htmlFor:"course",className:"text-sm font-normal",children:"Kelas Online"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{id:"bootcamp",checked:m.includes("bootcamp"),onCheckedChange:s=>C("bootcamp",!!s)}),e.jsx(t,{htmlFor:"bootcamp",className:"text-sm font-normal",children:"Bootcamp"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{id:"webinar",checked:m.includes("webinar"),onCheckedChange:s=>C("webinar",!!s)}),e.jsx(t,{htmlFor:"webinar",className:"text-sm font-normal",children:"Webinar"})]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Kosong = berlaku untuk semua produk"})]}),m.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Produk Spesifik (Opsional)"}),e.jsxs(w,{open:G,onOpenChange:K,children:[e.jsx(P,{asChild:!0,children:e.jsxs(u,{type:"button",variant:"outline",size:"sm",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Tambah Produk"]})}),e.jsx(S,{className:"w-80",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Jenis Produk"}),e.jsxs(M,{value:_,onValueChange:H,children:[e.jsx(V,{children:e.jsx(A,{})}),e.jsxs(B,{children:[m.includes("course")&&e.jsx(g,{value:"course",children:"Kelas Online"}),m.includes("bootcamp")&&e.jsx(g,{value:"bootcamp",children:"Bootcamp"}),m.includes("webinar")&&e.jsx(g,{value:"webinar",children:"Webinar"})]})]})]}),e.jsx("div",{className:"max-h-40 space-y-2 overflow-y-auto",children:$().map(s=>e.jsx("div",{className:"flex cursor-pointer items-center justify-between rounded-lg border p-2 hover:bg-gray-50",onClick:()=>Y(s,_),children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.title}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["Rp ",new Intl.NumberFormat("id-ID").format(s.price)]})]})},s.id))})]})})]})]}),j.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Produk yang dipilih:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map((s,a)=>e.jsxs(te,{variant:"secondary",className:"flex items-center gap-2",children:[e.jsxs("span",{children:[ee(s.type),": ",s.title]}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>Z(s),children:e.jsx(je,{className:"h-3 w-3"})})]},a))})]}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Kosong = berlaku untuk semua produk dari jenis yang dipilih"})]}),e.jsx(n,{control:r.control,name:"is_active",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-start space-y-0 space-x-3",children:[e.jsx(l,{children:e.jsx(y,{checked:s.value,onCheckedChange:s.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(t,{children:"Kode diskon aktif"}),e.jsx(h,{children:"Centang untuk mengaktifkan kode diskon"})]})]})})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(u,{type:"submit",className:"hover:cursor-pointer",children:"Simpan Kode Diskon"})})]})})]})]})}export{fs as default};
